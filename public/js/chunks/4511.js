(self.webpackChunkfusioncms=self.webpackChunkfusioncms||[]).push([[4511],{4511:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>o,getLink:()=>a});var i=t(6072);function a(e,n,t){axios.all([axios.get("/api/navigation/"+e+"/links/"+n),axios.get("/api/navigation/"+e)]).then(axios.spread((function(e,n){e=e.data.data,n=n.data.data;var i={name:e.name,url:e.url,new_window:Number(e.new_window).toString(),parent_id:e.parent_id,order:e.order,status:e.status};_.forEach(n.blueprint.sections,(function(n){_.forEach(n.fields,(function(n){i[n.handle]=e[n.handle]}))})),t(null,e,n,i)})))}const r={auth:function(){return{permission:"links.update"}},components:{"shared-form":t(2452).Z},data:function(){return{navigation:{},link:{},links:[],form:new i.Z({name:"",url:"",new_window:!1,parent_id:0,order:0,status:!1},!0),loading:!1}},methods:{submit:function(){var e=this;this.loading=!0,this.form.patch("/api/navigation/"+this.navigation.id+"/links/"+this.link.id).then((function(n){toast("Link saved successfully","success"),e.$router.push("/navigation/"+e.navigation.id+"/links")})).catch((function(n){toast(n.message,"failed"),e.loading=!1}))}},beforeRouteEnter:function(e,n,t){a(e.params.navigation,e.params.link,(function(e,n,a,r){t(e?function(n){n.$router.push("/navigation"),toast(e.toString(),"danger")}:function(e){e.navigation=a,e.link=n,e.form=new i.Z(r,!0),e.links=_.map(a.links,(function(e){return{label:e.name,value:e.id}})),e.links.unshift({label:"None",value:0}),e.$emit("updateHead")})}))}};const o=(0,t(1900).Z)(r,(function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",[t("portal",{attrs:{to:"title"}},[t("page-title",{attrs:{icon:"anchor"}},[e._v("Edit Link")])],1),e._v(" "),t("shared-form",{attrs:{loading:e.loading,form:e.form,submit:e.submit,navigation:e.navigation,link:e.link,links:e.links}})],1)}),[],!1,null,null,null).exports},2452:(e,n,t)=>{"use strict";t.d(n,{Z:()=>a});const i={props:{link:{type:Object,default:function(){return{}}},links:{type:Array,required:!0},navigation:{type:Object,required:!0},form:{type:Object,required:!0},submit:{required:!0},loading:{type:Boolean,required:!1}},computed:{sections:function(){var e=[],n=[];return this.navigation.blueprint&&(e=_.filter(this.navigation.blueprint.sections,(function(e){return"body"==e.placement})),n=_.filter(this.navigation.blueprint.sections,(function(e){return"sidebar"==e.placement}))),{body:e,sidebar:n}},fields:function(){var e=[],n=[];return this.navigation.blueprint&&(e=_.filter(this.navigation.blueprint.sections,(function(e){return"body"==e.placement})),e=_.flatMap(e,(function(e){return e.fields})),n=_.filter(this.navigation.blueprint.sections,(function(e){return"sidebar"==e.placement})),n=_.flatMap(n,(function(e){return e.fields}))),{body:e,sidebar:n}}}};const a=(0,t(1900).Z)(i,(function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",[t("portal",{attrs:{to:"actions"}},[t("div",{staticClass:"buttons"},[e.navigation.id&&"sm"!=e.$mq?t("ui-button",{attrs:{to:{name:"links",params:{navigation:e.navigation.id}},variant:"secondary"}},[e._v("Go Back")]):e._e(),e._v(" "),t("ui-button",{attrs:{type:"submit",variant:"primary",disabled:!e.form.hasChanges||e.loading},on:{click:function(n){return n.preventDefault(),e.submit(n)}}},[e._v("Save")])],1)]),e._v(" "),t("section-card",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],attrs:{title:"Loading..."}}),e._v(" "),t("portal",{attrs:{to:"sidebar-right"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:!e.loading,expression:"! loading"}]},[t("sidebar",{attrs:{id:"link-sidebar"}},[t("sidebar-section",{attrs:{id:"link_panel_status",tabindex:"-1"}},[t("ui-toggle",{attrs:{name:"status",label:"Status",help:e.form.status?"Toggle to disable this link.":"Toggle to enable this link.","true-value":!0,"false-value":!1},model:{value:e.form.status,callback:function(n){e.$set(e.form,"status",n)},expression:"form.status"}}),e._v(" "),t("ui-select-group",{attrs:{name:"new_window",label:"Open link where",help:"Determine where the link should open.",options:[{label:"New Window",value:"1"},{label:"Same Window",value:"0"}]},model:{value:e.form.new_window,callback:function(n){e.$set(e.form,"new_window",n)},expression:"form.new_window"}})],1)],1)],1)]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.loading,expression:"! loading"}]},[t("ui-card",{attrs:{id:"link_panel",tabindex:"-1"}},[t("ui-card-body",[t("ui-title-group",{attrs:{name:"name",label:"Name",autocomplete:"off",autofocus:"",required:"","has-error":e.form.errors.has("name"),"error-message":e.form.errors.get("name")},model:{value:e.form.name,callback:function(n){e.$set(e.form,"name",n)},expression:"form.name"}}),e._v(" "),t("ui-input-group",{attrs:{name:"url",label:"URL",help:"The URL of the link.",autocomplete:"off","has-error":e.form.errors.has("url"),"error-message":e.form.errors.get("url")},model:{value:e.form.url,callback:function(n){e.$set(e.form,"url",n)},expression:"form.url"}})],1)],1),e._v(" "),e._l(e.sections.body,(function(n){return t("section-card",{key:n.handle,attrs:{id:"collection_panel_"+n.handle,title:n.name,description:n.description,tabindex:"-1"}},[n.fields.length>0?t("div",e._l(n.fields,(function(n){return t(n.type.id+"-fieldtype",{key:n.handle,tag:"component",attrs:{field:n,errors:e.form.errors},model:{value:e.form[n.handle],callback:function(t){e.$set(e.form,n.handle,t)},expression:"form[field.handle]"}})})),1):e._e()])}))],2)],1)}),[],!1,null,null,null).exports}}]);